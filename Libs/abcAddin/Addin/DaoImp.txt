using System;
using System.Collections.Generic;
using System.Data.OleDb;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Citi.GSM.ExcelPlugins
{
    public class DaoImp : Dao
    {
        public InfoObject searchInfoByGeid(string geid)
        {
            string sql = "select ENAME,CNAME,SOEID from AddInTest where GEID = '{0}'";
            sql = string.Format(sql, geid);
            DBConnection.myCommand = new OleDbCommand(sql, DBConnection.mycon);
            DBConnection.myReader = DBConnection.myCommand.ExecuteReader();
            InfoObject info = new InfoObject();
            if (DBConnection.myReader.Read())
            {
                info.GeID = geid;
                info.CName = DBConnection.myReader["CNAME"].ToString();
                info.EName = DBConnection.myReader["CNAME"].ToString();
                info.SoeID = DBConnection.myReader["SOEID"].ToString();
            }
            return info;
        }

        public string searchCNameByGeid(string geid)
        {

            string sql = "select CNAME from AddInTest where GEID = '{0}'";
            sql = string.Format(sql, geid);
            DBConnection.myCommand = new OleDbCommand(sql, DBConnection.mycon);
            DBConnection.myReader = DBConnection.myCommand.ExecuteReader();
            string cName = "";
            if (DBConnection.myReader.Read())
            {
                cName = DBConnection.myReader["CNAME"].ToString();
            }
            return cName;
        }

        public string searchENameByGeid(string geid)
        {

            string sql = "select ENAME from AddInTest where GEID = '{0}'";
            sql = string.Format(sql, geid);
            DBConnection.myCommand = new OleDbCommand(sql, DBConnection.mycon);
            DBConnection.myReader = DBConnection.myCommand.ExecuteReader();
            string eName = "";
            if (DBConnection.myReader.Read())
            {
                eName = DBConnection.myReader["ENAME"].ToString();
            }
            return eName;
        }

        public string searchSoeidByGeid(string geid)
        {

            string sql = "select SOEID from AddInTest where GEID = '{0}'";
            sql = string.Format(sql, geid);
            DBConnection.myCommand = new OleDbCommand(sql, DBConnection.mycon);
            DBConnection.myReader = DBConnection.myCommand.ExecuteReader();
            string soeid = "";
            if (DBConnection.myReader.Read())
            {
                soeid = DBConnection.myReader["SOEID"].ToString();
            }
            return soeid;
        }
    }
}
